import{u as P,o as j,c as l,a as e,t as a,w,v as _,F as c,r as y,b as m,d as u,e as g,f as b,g as C,h as A,i as d,j as U,k as E,l as M,m as i}from"./index-DSVxf6YR.js";import{g as F,d as I}from"./client-Q6rv365W.js";import{C as S,B as O,P as R,p as T}from"./constants-ojXraNb3.js";const z={class:"flex flex-wrap items-center justify-between gap-4 mb-6"},K={class:"text-2xl font-semibold text-slate-900"},Y={class:"flex flex-wrap gap-2"},q={value:""},G=["value"],H={value:""},J=["value"],Q={value:""},W=["value"],X={key:0,class:"text-slate-600"},Z={key:1,class:"text-red-600 text-sm"},tt={key:2,class:"overflow-hidden rounded-xl bg-white shadow-sm ring-1 ring-slate-200"},et={class:"min-w-full divide-y divide-slate-200"},st={class:"bg-slate-900"},at={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},ot={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},lt={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},it={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},nt={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},rt={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},dt={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},pt={scope:"col",class:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-white"},ut={class:"divide-y divide-slate-200 bg-white"},ct={class:"whitespace-nowrap px-4 py-3"},mt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},ht={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},xt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},ft={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},vt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},yt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},wt={class:"whitespace-nowrap px-4 py-3 text-sm text-slate-600"},_t={key:1},gt={class:"whitespace-nowrap px-4 py-3"},bt={class:"flex gap-2"},kt=["onClick"],$t={key:3,class:"mt-4 text-slate-600"},Lt={class:"w-full max-w-sm rounded-xl bg-white p-6 shadow-xl ring-1 ring-slate-200"},Ct={class:"text-slate-700"},St={class:"mt-4 flex justify-end gap-2"},Pt={__name:"CardList",setup(Tt){const{t:V}=P();M();const h=d(!0),p=d(null),k=d([]),x=d(""),f=d(""),v=d(""),r=d(null),$=U(()=>{let t=k.value;return x.value&&(t=t.filter(o=>o.status===x.value)),f.value&&(t=t.filter(o=>o.bank===f.value)),v.value&&(t=t.filter(o=>o.pointsType===v.value)),t});function N(t){return S.find(n=>n.value===t)?V("status."+t):t}async function L(){var t,o;h.value=!0,p.value=null;try{k.value=await F()}catch(n){p.value=((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.error)||n.message}finally{h.value=!1}}function B(t){r.value=t}async function D(){var t,o;if(r.value)try{await I(r.value.id),r.value=null,await L()}catch(n){p.value=((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.error)||n.message}}return j(L),(t,o)=>{const n=E("router-link");return i(),l("div",null,[e("div",z,[e("h1",K,a(t.$t("cardList.title")),1),e("div",Y,[w(e("select",{"onUpdate:modelValue":o[0]||(o[0]=s=>x.value=s),class:"rounded-md border border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 text-sm py-1.5 pl-2 pr-8"},[e("option",q,a(t.$t("cardList.allStatuses")),1),(i(!0),l(c,null,y(m(S),s=>(i(),l("option",{key:s.value,value:s.value},a(t.$t("status."+s.value)),9,G))),128))],512),[[_,x.value]]),w(e("select",{"onUpdate:modelValue":o[1]||(o[1]=s=>f.value=s),class:"rounded-md border border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 text-sm py-1.5 pl-2 pr-8"},[e("option",H,a(t.$t("cardList.allBanks")),1),(i(!0),l(c,null,y(m(O),s=>(i(),l("option",{key:s,value:s},a(s),9,J))),128))],512),[[_,f.value]]),w(e("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),class:"rounded-md border border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 text-sm py-1.5 pl-2 pr-8"},[e("option",Q,a(t.$t("cardList.allPointTypes")),1),(i(!0),l(c,null,y(m(R),s=>(i(),l("option",{key:s,value:s},a(m(T)(s)),9,W))),128))],512),[[_,v.value]])])]),h.value?(i(),l("p",X,a(t.$t("cardList.loading")),1)):p.value?(i(),l("p",Z,a(p.value),1)):(i(),l("div",tt,[e("table",et,[e("thead",st,[e("tr",null,[e("th",at,a(t.$t("cardList.card")),1),e("th",ot,a(t.$t("cardList.type")),1),e("th",lt,a(t.$t("cardList.bank")),1),e("th",it,a(t.$t("cardList.status")),1),e("th",nt,a(t.$t("cardList.pointsType")),1),e("th",rt,a(t.$t("cardList.pointsValue")),1),e("th",dt,a(t.$t("cardList.annualCost")),1),e("th",pt,a(t.$t("cardList.lastSnapshot")),1),o[5]||(o[5]=e("th",{scope:"col",class:"relative px-4 py-3"},[e("span",{class:"sr-only"},"Actions")],-1))])]),e("tbody",ut,[(i(!0),l(c,null,y($.value,s=>(i(),l("tr",{key:s.id,class:"hover:bg-slate-50/50"},[e("td",ct,[g(n,{to:`/cards/${s.id}`,class:"font-medium text-primary-600 hover:text-primary-700"},{default:b(()=>[u(a(s.cardName),1)]),_:2},1032,["to"])]),e("td",mt,a(s.type),1),e("td",ht,a(s.bank),1),e("td",xt,a(N(s.status)),1),e("td",ft,a(m(T)(s.pointsType)),1),e("td",vt,a(s.pointsValue??"–"),1),e("td",yt,a(s.annualCost!=null?`$${s.annualCost}`:"–"),1),e("td",wt,[s.lastSnapshot?(i(),l(c,{key:0},[u(a(s.lastSnapshot.weekStartDate)+": "+a(s.lastSnapshot.pointsValue)+" pts",1)],64)):(i(),l("span",_t,"–"))]),e("td",gt,[e("div",bt,[g(n,{to:`/cards/${s.id}/snapshots`,class:"rounded-md bg-white px-2.5 py-1 text-sm font-medium text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50"},{default:b(()=>[u(a(t.$t("cardList.snapshots")),1)]),_:1},8,["to"]),e("button",{type:"button",class:"rounded-md px-2.5 py-1 text-sm font-medium text-red-600 ring-1 ring-red-300 hover:bg-red-50",onClick:Vt=>B(s)},a(t.$t("cardList.delete")),9,kt)])])]))),128))])])])),!h.value&&!p.value&&$.value.length===0?(i(),l("p",$t,[u(a(t.$t("cardList.noCards"))+" ",1),g(n,{to:"/cards/new",class:"font-medium text-primary-600 hover:text-primary-700"},{default:b(()=>[u(a(t.$t("cardList.addOne")),1)]),_:1}),o[6]||(o[6]=u(". ",-1))])):C("",!0),r.value?(i(),l("div",{key:4,class:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 p-4",onClick:o[4]||(o[4]=A(s=>r.value=null,["self"]))},[e("div",Lt,[e("p",Ct,a(t.$t("cardList.deleteConfirm",{name:r.value.cardName})),1),e("div",St,[e("button",{type:"button",class:"rounded-md bg-white px-3 py-1.5 text-sm font-medium text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50",onClick:o[3]||(o[3]=s=>r.value=null)},a(t.$t("cardList.cancel")),1),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-red-700",onClick:D},a(t.$t("cardList.delete")),1)])])])):C("",!0)])}}};export{Pt as default};
